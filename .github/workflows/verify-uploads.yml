name: Verify YouTube Uploads

on:
  workflow_run:
    workflows: ["Publish YouTube Shorts", "Publish Long-Form Videos"]
    types: [completed]
  workflow_dispatch:

jobs:
  verify:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: Check state file
        run: |
          if [ ! -f state/state.json ]; then
            echo "❌ State file not found"
            exit 1
          fi
          
          total_shorts=$(python -c "import json; d=json.load(open('state/state.json')); print(len(d.get('publishes', {})))" 2>/dev/null || echo "0")
          echo "✅ Total published shorts: $total_shorts"
          
          if [ "$total_shorts" -lt 1 ]; then
            echo "⚠️ No shorts uploaded yet"
          fi
